---
description: High-level architecture and system design for OC Pipeline
alwaysApply: false
---

# OC PIPELINE - PROJECT OVERVIEW

## ğŸ¯ EXECUTIVE SUMMARY

OC Pipeline is a **federal-grade, multi-tenant SaaS platform** for complex healthcare, federal, and mission-critical commercial construction projects.

**Key Differentiators:**
- 16 integrated modules (full project lifecycle)
- ATLAS agentic AI system (17 specialized agents)
- Federal compliance (NIST 800-171, SOC 2, FISMA)
- 67% reduction in development time/cost vs. traditional approaches

---

## ğŸ“Š SYSTEM ARCHITECTURE

### **Three-Tier Architecture**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 FRONTEND (Vercel)                        â”‚
â”‚         React 18 + TypeScript + Vite + shadcn/ui        â”‚
â”‚                https://ocpipeline.vercel.app            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ HTTPS/REST
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BACKEND (Render)                        â”‚
â”‚           Node.js + Express + TypeScript                 â”‚
â”‚             https://oc-pipeline.onrender.com            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ PostgreSQL Wire Protocol
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DATABASE (Supabase)                      â”‚
â”‚       PostgreSQL 15 + RLS + Real-time + Auth            â”‚
â”‚           Project: cwrjhtpycynjzeiggyhf                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ MODULE ARCHITECTURE

### **Lifecycle Flow**

```
PRECONSTRUCTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
â”‚
â”œâ”€â”€ Bids & Pursuits
â”œâ”€â”€ Estimates & Takeoffs
â”œâ”€â”€ Bid Packages
â””â”€â”€ Pipeline Management

                    EXECUTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
                    â”‚
                    â”œâ”€â”€ Cost Management
                    â”œâ”€â”€ Schedule Control
                    â”œâ”€â”€ Risk Mitigation
                    â”œâ”€â”€ Quality Assurance
                    â”œâ”€â”€ Safety Compliance
                    â”œâ”€â”€ Procurement
                    â”œâ”€â”€ Communications (RFI/Submittal)
                    â””â”€â”€ Staffing & Resources

                                        CLOSEOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
                                        â”‚
                                        â”œâ”€â”€ Warranties
                                        â”œâ”€â”€ As-Builts
                                        â”œâ”€â”€ Handover
                                        â””â”€â”€ Lessons Learned

CROSS-CUTTING â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”œâ”€â”€ Administration (Users, Roles, Audit)
â”œâ”€â”€ Portfolio (Multi-project Analytics)
â”œâ”€â”€ Documents (Version Control)
â”œâ”€â”€ Tasks (Workflow Engine)
â”œâ”€â”€ Finance (Detailed Views)
â””â”€â”€ ATLAS (AI Agents)
```

---

## ğŸ”— MODULE DEPENDENCIES

| Module | Depends On | Provides To |
|--------|------------|-------------|
| Preconstruction | Admin, Documents | Cost, Schedule, Portfolio |
| Cost | Preconstruction, Admin | Schedule, Finance, Portfolio |
| Schedule | Cost, Preconstruction | Risk, Tasks, Portfolio |
| Risk | Schedule, Cost | Quality, Safety |
| Quality | Risk, Documents | Closeout |
| Safety | Risk, Staffing | Quality, Portfolio |
| Procurement | Cost, Documents | Schedule, Finance |
| Communications | All modules | Documents, Tasks |
| Staffing | Admin, Schedule | Safety, Cost |
| Closeout | All modules | Portfolio, Documents |
| Admin | - | All modules |
| Portfolio | All modules | - |
| Documents | Admin | All modules |
| Tasks | Admin | All modules |
| Finance | Cost, Procurement | Portfolio |
| ATLAS | All modules | All modules |

---

## ğŸ“ˆ DATA FLOW PATTERNS

### **1. Project Creation Flow**
```
User creates project
    â”‚
    â”œâ”€â”€ Insert into `projects` table
    â”œâ”€â”€ Create default budget structure
    â”œâ”€â”€ Initialize schedule milestones
    â”œâ”€â”€ Create document folder structure
    â”œâ”€â”€ Assign default team members
    â””â”€â”€ Trigger ATLAS agent initialization
```

### **2. Change Order Flow**
```
Change order submitted
    â”‚
    â”œâ”€â”€ Insert into `change_orders` table
    â”œâ”€â”€ Update `budgets.contingency`
    â”œâ”€â”€ Recalculate `cost_forecasts`
    â”œâ”€â”€ Update `schedule_impacts`
    â”œâ”€â”€ Trigger risk assessment
    â”œâ”€â”€ Notify stakeholders
    â””â”€â”€ Log to audit trail
```

### **3. RFI Workflow**
```
RFI created
    â”‚
    â”œâ”€â”€ Insert into `rfis` table
    â”œâ”€â”€ Assign to responsible party
    â”œâ”€â”€ Set due date (SLA)
    â”œâ”€â”€ Create task in `tasks` table
    â”œâ”€â”€ Send notification
    â”œâ”€â”€ Track response time
    â””â”€â”€ Link to schedule impact (if any)
```

---

## ğŸ¯ KEY BUSINESS METRICS

### **Project Health KPIs**
- **CPI** (Cost Performance Index): EV / AC
- **SPI** (Schedule Performance Index): EV / PV
- **TRIR** (Total Recordable Incident Rate): (Incidents Ã— 200,000) / Hours
- **DART** (Days Away/Restricted/Transfer): (Cases Ã— 200,000) / Hours
- **EMR** (Experience Modification Rate): Company safety rating

### **Pipeline Metrics**
- **Weighted Pipeline Value**: Î£(Project Value Ã— Win Probability)
- **Win Rate**: Rolling 90-day calculation
- **Capacity Utilization**: Active Value / $30M Baseline
- **Stage Velocity**: Projects moved / Time period

### **Financial Metrics**
- **EAC** (Estimate at Completion): AC + ETC
- **VAC** (Variance at Completion): BAC - EAC
- **TCPI** (To-Complete Performance Index): (BAC - EV) / (BAC - AC)

---

## ğŸ” SECURITY ARCHITECTURE

### **Authentication Flow**
```
User login request
    â”‚
    â”œâ”€â”€ Supabase Auth validates credentials
    â”œâ”€â”€ Generate JWT (1hr access, 30-day refresh)
    â”œâ”€â”€ Set session cookie (httpOnly, secure)
    â”œâ”€â”€ Log login to audit trail
    â””â”€â”€ Return user profile + permissions
```

### **Authorization Flow**
```
API request received
    â”‚
    â”œâ”€â”€ Extract JWT from header
    â”œâ”€â”€ Verify JWT signature
    â”œâ”€â”€ Check token expiration
    â”œâ”€â”€ Load user permissions from cache/DB
    â”œâ”€â”€ Check RBAC for requested action
    â”œâ”€â”€ Apply RLS policies at DB level
    â””â”€â”€ Execute request or return 403
```

---

## ğŸš€ DEPLOYMENT ARCHITECTURE

### **Production Environment**

| Component | Service | URL |
|-----------|---------|-----|
| Frontend | Vercel | https://ocpipeline.vercel.app |
| Backend | Render | https://oc-pipeline.onrender.com |
| Database | Supabase | cwrjhtpycynjzeiggyhf.supabase.co |
| Storage | Supabase | S3-compatible object storage |
| Auth | Supabase | Built-in with Google/Microsoft OAuth |

### **Environment Variables**

**Frontend (.env)**
```
VITE_SUPABASE_URL=https://cwrjhtpycynjzeiggyhf.supabase.co
VITE_SUPABASE_ANON_KEY=<anon-key>
VITE_API_URL=https://oc-pipeline.onrender.com
```

**Backend (.env)**
```
DATABASE_URL=postgresql://...
SUPABASE_SERVICE_ROLE_KEY=<service-role-key>
JWT_SECRET=<jwt-secret>
PORT=3001
```

---

$END$

*Context added by project overview - High-level architecture, module dependencies, data flow patterns, and deployment configuration.*
